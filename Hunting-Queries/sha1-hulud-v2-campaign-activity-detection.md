```
// References: https://www.koi.ai/incident/live-updates-sha1-hulud-the-second-coming-hundred-npm-packages-compromised
// https://safedep.io/shai-hulud-second-coming-supply-chain-attack/
|case{
    in(field="SHA256HashData", values=["a3894003ad1d293ba96d77881ccd2071446dc3f65f434669b49b3da92421901a", // setup_bun.js
    "62ee164b9b306250c1172583f138c9614139264f889fa99614903c12755468d0", // bun_environment.js
    "f099c5d9ec417d4445a0328ac0ada9cde79fc37410914103ae9c609cbc0ee068", // bun_environment.js
    "cbb9bc5a8496243e02f3cc080efbe3e4a1430ba0671f2e43a202bf45b05479cd"  // bun_environment.js
    ])|Analysis:="Confirmed Malicious Hashes";
    FileName="discussion.yaml" FilePath=/\.github[\\\/]workflows[\\\/]/ |Analysis:="Discussion.yaml";
    event_platform=/macOS|linux/iF #event_simpleName=ProcessRollup2 |in(field="CommandLine", values=["*find*","*shred*","*xargs*","*-delete*","*$HOME*"],ignoreCase=true)|Analysis:="Linux/macOS destructive command"; 
    event_platform=/win/iF #event_simpleName=ProcessRollup2 ParentBaseFileName=/cmd\.exe/i |in(field="CommandLine", values=["*/c*del*/f*/q*/s*","*%USERPROFILE%*"])|Analysis:="Windows destructive command";
    in(field="ParentBaseFileName", values=["npm.exe", "npm", "pnpm.exe", "pnpm"]) | CommandLine ="*setup_bun.js*" |Analysis:="Detect initial execution via npm preinstall script";
      #event_simpleName=InstalledApplication |in(field="AppName", values=["concerto-analysis","concerto-linter","concerto-linter-default-ruleset","concerto-metamodel","concerto-types","markdown-it-cicero","template-engine","css-to-react-native-transform","native","node-server","react-absolute","react-daum-postcode","react-kakaosdk","react-native-actionsheet","react-native-devtools","react-native-fast-image","react-native-kakao-channel","react-native-kakao-navi","react-native-less-transformer","react-native-naver-login","react-native-simple-video","react-native-tiktok","api","storage","s2s-auth","amadeus-api","gatsby-theme-events","gatsby-theme-wordpress-blog","reusable-functions","nuxt-socket.io","nuxt-socket.io","nuxt-ux","nuxt-ux","eslint-config-antstack","express-graphql-proxy","graphql-body-parser","json-to-graphql","shelbysam","my-angular-lib","avro-schema-parser","avro-schema-parser","bundler","bundler","cli","cli","converter","converter","diff","diff","dotnet-rabbitmq-template","dotnet-rabbitmq-template","edavisualiser","edavisualiser","generator","generator","generator-components","generator-components","generator-helpers","generator-helpers","generator-react-sdk","generator-react-sdk","go-watermill-template","go-watermill-template","html-template","html-template","java-spring-cloud-stream-template","java-spring-cloud-stream-template","java-spring-template","java-spring-template","java-template","java-template","keeper","keeper","markdown-template","markdown-template","modelina","modelina-cli","modelina-cli","multi-parser","multi-parser","nodejs-template","nodejs-template","nodejs-ws-template","nodejs-ws-template","nunjucks-filters","nunjucks-filters","openapi-schema-parser","openapi-schema-parser","optimizer","optimizer","parser","parser","php-template","php-template","problem","problem","protobuf-schema-parser","protobuf-schema-parser","protobuf-schema-parser","python-paho-template","python-paho-template","react-component","react-component","server-api","server-api","specs","specs","studio","studio","web-component","web-component","knex-ibmi","bb9","director-ai","mcp","mcp-server-browserbase","sdk-functions","stagehand","stagehand-docs","caret-cli","eslint-config","flows-step-httprequest","flows-step-jsontoxml","flows-step-mqtt","flows-step-sendgridemail","flows-step-taskscreateurl","ghl","bloom","market-data","market-data-chartjs","ai-qa-logic","blinqioclient","cucumber-js","cucumber_client","ui-systems","address-encoder","blacklist","buffer","ccip-read-cf-worker","ccip-read-dns-gateway","ccip-read-router","ccip-read-worker-viem","content-hash","curvearithmetics","cypress-metamask","dnsprovejs","dnssec-oracle-anchors","dnssecoraclejs","durin","durin-middleware","ens-archived-contracts","ens-avatar","ens-contracts","ens-test-env","ens-validation","ensjs","ensjs-react","eth-ens-namehash","hackathon-registrar","hardhat-chai-matchers-viem","hardhat-toolbox-viem-extended","mock","name-wrapper","offchain-resolver-contracts","op-resolver-contracts","react-ens-address","renewal","renewal-widget","reverse-records","server-analytics","solsha1","subdomain-registrar","test-utils","thorin","ui","unicode-confusables","unruggable-gateways","vite-plugin-i18next-loader","web3modal","react-charts","validate-esmoduleinterop-imports","validate-esmoduleinterop-imports","web-analytics","core","react","browser-sync-plugin","react-loader","react-pagination","react-raty","react-swiper","n8n-nodes-pgp","core","react","auth-vue","core","core-nuxt","form-naiveui","i18n","ui","telemetry-sdk","protocol-contracts-svm-idl","protocol-contracts-svm-idl","design-system","metatron3","telemetry-sdk","cli","components","habbit-e2e-test","medusa-plugin-announcement","medusa-plugin-management","medusa-plugin-newsletter","medusa-plugin-product-reviews","medusa-plugin-promotion","web","api-client","api-client","babel-preset","electron-group-api-client","eslint-config","material-icons","react-table-context","schoolbus","schoolbus","live-edit","nuxt-live-edit","rn-zustand-expo-template","core","cortex-js","firestore-repo-service","lui-nuxt","lui-tailwindcss","lui-vue","app-version-checker","cli","cli","inspector","inspector","mcp-use","mcp-use","stadtmarketing-kufstein-external","orm","passport-wso2","t","accordion","alert-dialog","arrow","aspect-ratio","avatar","checkbox","collapsible","collection","dialog","direction","dismissable-layer","focus-guards","focus-scope","hover-card","label","menu","motion","motion-nuxt","popover","popper","portal","presence","primitive","primitives","primitives-nuxt","progress","provide","radio-group","roving-focus","scroll-area","separator","slider","slot","switch","tabs","toast","toggle","toggle-group","toolbar","tooltip","use-composable","utils","visually-hidden","mapbox-gl-draw-cut-polygon-mode","mapbox-gl-draw-scale-rotate-mode","orbit-components","time-slider","bmad","error-handler","cli","module-box","module-graphql","module-ui","nuxt","agent","ai","automatic-cohorts-plugin","bitbucket-release-tracker","cli","clickhouse","core","currency-normalization-plugin","customerio-plugin","databricks-plugin","drop-events-on-property-plugin","event-sequence-timer-plugin","filter-out-plugin","first-time-event-tracker","geoip-plugin","github-release-tracking-plugin","gitub-star-sync-plugin","heartbeat-plugin","hedgehog-mode","icons","ingestion-alert-plugin","intercom-plugin","kinesis-plugin","laudspeaker-plugin","lemon-ui","maxmind-plugin","migrator3000-plugin","netdata-event-processing","nextjs","nextjs-config","nuxt","pagerduty-plugin","piscina","plugin-contrib","plugin-server","plugin-unduplicates","postgres-plugin","react-rrweb-player","rrdom","rrweb","rrweb-player","rrweb-record","rrweb-replay","rrweb-snapshot","rrweb-utils","sendgrid-plugin","siphash","snowflake-export-plugin","taxonomy-plugin","twilio-plugin","twitter-followers-plugin","url-normalizer-plugin","variance-plugin","web-dev-server","wizard","zendesk-plugin","csv-parse","csv-parse","final-node-keytar","final-node-keytar","final-node-keytar","mcp-ui-client","mcp-ui-client","node-keytar","node-keytar","pm-bin-linux-x64","pm-bin-linux-x64","pm-bin-linux-x64","pm-bin-macos-arm64","pm-bin-macos-arm64","pm-bin-macos-x64","pm-bin-macos-x64","pm-bin-windows-x64","pm-bin-windows-x64","postman-collection-fork","postman-collection-fork","postman-mcp-cli","postman-mcp-cli","postman-mcp-cli","postman-mcp-server","postman-mcp-server","pretty-ms","pretty-ms","pretty-ms","secret-scanner-wasm","secret-scanner-wasm","tunnel-agent","tunnel-agent","tunnel-agent","wdio-allure-reporter","wdio-allure-reporter","wdio-junit-reporter","wdio-junit-reporter","wdio-junit-reporter","common-app","animejs-vue","auth","chatwoot","motion","ts-i18n","use-debounce","quick-document-translator","quick-git-clean-markdown","quick-markdown","quick-markdown-compose","quick-markdown-image","quick-markdown-print","quick-markdown-translator","quick-remove-image-background","quick-task-refine","claude-context-core","claude-context-mcp","sor","sor2","sdr-mcp-server","next","openapi-generator","react-hooks","react-native-action-sheet","better-auth","drizzle","ecosystem","graphql","module-builder","openapi","permission","ratelimit","scalar","yoga","aoma-vevasound-metadata-lib","react-native-date-time-picker","react-native-perspective-image-cropper","react-native-perspective-image-cropper-2","react-native-perspective-image-cropper-poojan31","medium-common","eslint-config","json","json","react-progressbar","react-progressbar","angular-trackstar-link","react-trackstar-link","react-trackstar-link-upgrade","test-angular-package","test-package","sleekshop-js","atrix","atrix-acl","atrix-elasticsearch","atrix-mongoose","atrix-orientdb","atrix-postgres","atrix-pubsub","atrix-redis","atrix-soap","atrix-swagger","bool-expressions","eslint-config-trigo","fsm","hapi-auth-signedlink","jsdt","keycloak-api","node-soap","pathfinder-ui-css","trigo-hapijs","cloudflare","hono","api-client","api-client","utils","validation-schemas","validation-schemas","eslint-config","full-year-calendar","alexa-types","anthropic","anthropic","api-sdk","backend-utils","backend-utils","base-types","base-types","body-parser","body-parser","chat-types","chat-types","circleci-config-sdk-orb-import","circleci-config-sdk-orb-import","commitlint-config","commitlint-config","common","common","default-prompt-wrappers","default-prompt-wrappers","dependency-cruiser-config","dependency-cruiser-config","dtos-interact","dtos-interact","encryption","encryption","eslint-config","eslint-config","eslint-plugin","eslint-plugin","exception","exception","fetch","fetch","general-types","general-types","git-branch-check","git-branch-check","google-dfes-types","google-dfes-types","google-types","husky-config","husky-config","logger","logger","metrics","metrics","natural-language-commander","natural-language-commander","nestjs-common","nestjs-common","nestjs-mongodb","nestjs-mongodb","nestjs-rate-limit","nestjs-rate-limit","nestjs-redis","nestjs-redis","nestjs-timeout","nestjs-timeout","npm-package-json-lint-config","openai","openai","pino","pino","pino-pretty","pino-pretty","prettier-config","prettier-config","react-chat","runtime","runtime","runtime-client-js","runtime-client-js","sdk-runtime","sdk-runtime","secrets-provider","secrets-provider","semantic-release-config","semantic-release-config","serverless-plugin-typescript","serverless-plugin-typescript","slate-serializer","slate-serializer","stitches-react","stitches-react","storybook-config","storybook-config","stylelint-config","stylelint-config","test-common","test-common","tsconfig","tsconfig","tsconfig-paths","tsconfig-paths","utils-designer","verror","verror","vite-config","vite-config","vitest-config","vitest-config","voice-types","voice-types","voiceflow-types","voiceflow-types","widget","widget","email","ai-actions","ai-actions","ai-actions","ai-actions-react","ai-actions-react","ai-actions-react","babel-preset-zapier","babel-preset-zapier","babel-preset-zapier","browserslist-config-zapier","browserslist-config-zapier","browserslist-config-zapier","eslint-plugin-zapier","eslint-plugin-zapier","eslint-plugin-zapier","mcp-integration","mcp-integration","mcp-integration","secret-scrubber","secret-scrubber","secret-scrubber","spectral-api-ruleset","spectral-api-ruleset","spectral-api-ruleset","stubtree","stubtree","stubtree","zapier-sdk","zapier-sdk","zapier-sdk","ai-crowl-shield","arc-cli-fc","asciitranslator","asyncapi-preview","asyncapi-preview","atrix","atrix-mongoose","automation_model","avvvatars-vue","axios-builder","axios-cancelable","axios-cancelable","axios-timed","axios-timed","babel-preset-kinvey-flex-service","barebones-css","barebones-css","benmostyn-frame-print","best_gpio_controller","better-auth-nuxt","better-queue-nedb","bidirectional-adapter","bidirectional-adapter","bidirectional-adapter","bidirectional-adapter","blinqio-executions-cli","blob-to-base64","bool-expressions","buffered-interpolation-babylon6","bun-plugin-httpfile","bytecode-checker-cli","bytecode-checker-cli","bytecode-checker-cli","bytecode-checker-cli","bytes-to-x","calc-loan-interest","capacitor-plugin-apptrackingios","capacitor-plugin-purchase","capacitor-plugin-scgssigninwithgoogle","capacitor-purchase-history","capacitor-voice-recorder-wav","ceviz","chrome-extension-downloads","chrome-extension-downloads","claude-token-updater","coinmarketcap-api","coinmarketcap-api","colors-regex","command-irail","compare-obj","compare-obj","composite-reducer","composite-reducer","composite-reducer","composite-reducer","count-it-down","count-it-down","cpu-instructions","create-director-app","create-glee-app","create-glee-app","create-hardhat3-app","create-hardhat3-app","create-hardhat3-app","create-hardhat3-app","create-kinvey-flex-service","create-mcp-use-app","create-mcp-use-app","create-silgi","crypto-addr-codec","css-dedoupe","csv-tool-cli","dashboard-empty-state","designstudiouiux","devstart-cli","dialogflow-es","dialogflow-es","dialogflow-es","discord-bot-server","docusaurus-plugin-vanilla-extract","dont-go","dotnet-template","dotnet-template","drop-events-on-property-plugin","easypanel-sdk","electron-volt","email-deliverability-tester","enforce-branch-name","esbuild-plugin-brotli","esbuild-plugin-eta","esbuild-plugin-httpfile","eslint-config-kinvey-flex-service","eslint-config-nitpicky","eslint-config-trigo","eslint-config-zeallat-base","ethereum-ens","evm-checkcode-cli","evm-checkcode-cli","evm-checkcode-cli","evm-checkcode-cli","exact-ticker","expo-audio-session","expo-router-on-rails","express-starter-template","expressos","fat-fingered","fat-fingered","feature-flip","feature-flip","firestore-search-engine","fittxt","fittxt","flapstacks","flapstacks","flatten-unflatten","flatten-unflatten","formik-error-focus","formik-store","frontity-starter-theme","fuzzy-finder","fuzzy-finder","gate-evm-check-code2","gate-evm-check-code2","gate-evm-check-code2","gate-evm-check-code2","gate-evm-tools-test","gate-evm-tools-test","gate-evm-tools-test","gate-evm-tools-test","gatsby-plugin-antd","gatsby-plugin-cname","gatsby-plugin-cname","generator-meteor-stock","generator-ng-itobuz","get-them-args","github-action-for-generator","github-action-for-generator","gitsafe","go-template","go-template","gulp-inject-envs","gulp-inject-envs","haufe-axera-api-client","hope-mapboxdraw","hopedraw","hover-design-prototype","httpness","httpness","hyper-fullfacing","hyperterm-hipster","ids-css","ids-enterprise-mcp-server","ids-enterprise-typings","image-to-uri","image-to-uri","insomnia-plugin-random-pick","invo","iron-shield-miniapp","ito-button","itobuz-angular","itobuz-angular-auth","itobuz-angular-button","jacob-zuma","jacob-zuma","jaetut-varit-test","jan-browser","jquery-bindings","jquery-bindings","jsonsurge","just-toasty","kill-port","kill-port","kinetix-default-token-list","kinvey-cli-wrapper","kinvey-flex-scripts","kns-error-code","korea-administrative-area-geo-json-util","kwami","kwami","lang-codes","lang-codes","license-o-matic","license-o-matic","lint-staged-imagemin","lint-staged-imagemin","lite-serper-mcp-server","lui-vue-test","luno-api","m25-transaction-utils","manual-billing-system-miniapp-api","mcp-use","mcp-use","medusa-plugin-announcement","medusa-plugin-logs","medusa-plugin-momo","medusa-plugin-product-reviews-kvy","medusa-plugin-zalopay","mod10-check-digit","mon-package-react-typescript","my-saeed-lib","n8n-nodes-tmdb","n8n-nodes-vercel-ai-sdk","n8n-nodes-viral-app","nanoreset","nanoreset","next-circular-dependency","next-circular-dependency","next-simple-google-analytics","next-simple-google-analytics","next-styled-nprogress","next-styled-nprogress","ngx-useful-swiper-prosenjit","ngx-wooapi","nitro-graphql","nitro-kutu","nitrodeploy","nitroping","normal-store","normal-store","normal-store","normal-store","nuxt-keycloak","obj-to-css","obj-to-css","okta-react-router-6","open2internet","orbit-boxicons","orbit-nebula-draw-tools","orbit-nebula-editor","orbit-soap","orchestrix","package-tester","parcel-plugin-asset-copier","parcel-plugin-asset-copier","pdf-annotation","pergel","pergeltest","piclite","pico-uid","pico-uid","pkg-readme","poper-react-sdk","posthog-docusaurus","posthog-js","posthog-node","posthog-node","posthog-plugin-hello-world","posthog-react-native","posthog-react-native","posthog-react-native-session-replay","prime-one-table","prompt-eng","prompt-eng-server","puny-req","quickswap-ads-list","quickswap-default-staking-list","quickswap-default-staking-list-address","quickswap-default-token-list","quickswap-router-sdk","quickswap-sdk","quickswap-smart-order-router","quickswap-token-lists","quickswap-v2-sdk","ra-auth-firebase","ra-data-firebase","ra-data-firebase","react-component-taggers","react-data-to-export","react-element-prompt-inspector","react-favic","react-hook-form-persist","react-hook-form-persist","react-jam-icons","react-jam-icons","react-keycloak-context","react-keycloak-context","react-library-setup","react-linear-loader","react-micromodal.js","react-micromodal.js","react-native-datepicker-modal","react-native-datepicker-modal","react-native-email","react-native-email","react-native-fetch","react-native-fetch","react-native-get-pixel-dimensions","react-native-get-pixel-dimensions","react-native-google-maps-directions","react-native-jam-icons","react-native-jam-icons","react-native-log-level","react-native-log-level","react-native-modest-checkbox","react-native-modest-storage","react-native-phone-call","react-native-phone-call","react-native-retriable-fetch","react-native-retriable-fetch","react-native-use-modal","react-native-view-finder","react-native-view-finder","react-native-websocket","react-native-websocket","react-native-worklet-functions","react-packery-component","react-qr-image","react-scrambled-text","rediff","rediff-viewer","redux-forge","redux-router-kit","redux-router-kit","redux-router-kit","revenuecat","rollup-plugin-httpfile","sa-company-registration-number-regex","sa-company-registration-number-regex","sa-id-gen","sa-id-gen","samesame","scgs-capacitor-subscribe","scgsffcreator","schob","selenium-session","selenium-session-client","set-nested-prop","set-nested-prop","shelf-jwt-sessions","shell-exec","shell-exec","shinhan-limit-scrap","silgi","simplejsonform","skills-use","skills-use","solomon-api-stories","solomon-v3-stories","solomon-v3-ui-wrapper","soneium-acs","sort-by-distance","south-african-id-info","stat-fns","stoor","sufetch","super-commit","svelte-autocomplete-select","svelte-toasty","svelte-toasty","tanstack-shadcn-table","tavily-module","tcsp","tcsp-draw-test","tcsp-test-vd","template-lib","template-lib","template-micro-service","template-micro-service","tenacious-fetch","tenacious-fetch","test-foundry-app","test-foundry-app","test-foundry-app","test-foundry-app","test-hardhat-app","test-hardhat-app","test-hardhat-app","test-hardhat-app","test23112222-api","tiaan","tiptap-shadcn-vue","token.js-fork","toonfetch","trigo-react-app","ts-relay-cursor-paging","typeface-antonio-complete","typefence","typefence","typeorm-orbit","unadapter","undefsafe-typed","undefsafe-typed","unemail","uniswap-router-sdk","uniswap-smart-order-router","uniswap-test-sdk-core","unsearch","uplandui","upload-to-play-store","upload-to-play-store","url-encode-decode","url-encode-decode","use-unsaved-changes","v-plausible","valid-south-african-id","valuedex-sdk","vf-oss-template","vf-oss-template","vf-oss-template","victoria-wallet-constants","victoria-wallet-constants","victoria-wallet-core","victoria-wallet-core","victoria-wallet-type","victoria-wallet-type","victoria-wallet-utils","victoria-wallet-utils","victoria-wallet-validator","victoria-wallet-validator","victoriaxoaquyet-wallet-core","victoriaxoaquyet-wallet-core","vite-plugin-httpfile","vue-browserupdate-nuxt","wallet-evm","wallet-evm","wallet-type","wallet-type","web-scraper-mcp","web-types-htmx","web-types-lit","webpack-loader-httpfile","wellness-expert-ng-gallery","wenk","wenk","zapier-async-storage","zapier-async-storage","zapier-async-storage","zapier-platform-cli","zapier-platform-cli","zapier-platform-cli","zapier-platform-core","zapier-platform-core","zapier-platform-core","zapier-platform-legacy-scripting-runner","zapier-platform-legacy-scripting-runner","zapier-platform-legacy-scripting-runner","zapier-platform-schema","zapier-platform-schema","zapier-platform-schema","zapier-scripts","zapier-scripts","zuper-cli","zuper-sdk","zuper-stream"],ignoreCase=true)|Analysis:="Installation Detected, Confirm the Vulnerable Version Number";
  #event_simpleName=InstalledApplication| in(field="AppVendor", values=["02-echo","accordproject","actbase","afetcan","alaan","alexadark","alexcolls","antstackio","aryanhussain","asyncapi","bdkinc","browserbasehq","caretive","chtijs","clausehq","cllbk","commute","dev-blinq","ensdomains","everreal","faq-component","fishingbooker","hapheus","hover-design","huntersofbook","hyperlook","ifelsedeveloper","ifings","jayeshsadhwani","kvytech","lessondesk","livecms","lokeswari-satyanarayanan","louisle2","lpdjs","lui-ui","markvivanco","mcp-use","micado-digital","mizzle-dev","ntnx","oku-ui","orbitgtbelgium","osmanekrem","pergel","posthog","postman","pradhumngautam","productdevbook","pruthvi21","quick-start-soft","relyt","sameepsi","seezo","seung-ju","silgi","sme-ui","strapbuild","suraj_h","thedelta","tiaanduplessis","trackstar","trefox","trigo","trpc-rate-limiter","varsityvibe","viapip","vishadtyagi","voiceflow","vucod","zapier"],ignoreCase=true)|Analysis:="App Vendor Detected, Confirm the Vulnerable App & Versions";
}
|$ProcessTree2()
|groupBy([Analysis,ProcessTree,CommandLineTree,AppName,AppVendor,SHA256HashData],function=collect([ComputerName]))
|select([Analysis,ComputerName,ProcessTree,CommandLineTree,SHA256HashData])
```
